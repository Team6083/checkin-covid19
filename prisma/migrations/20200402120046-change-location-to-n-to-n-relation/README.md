# Migration `20200402120046-change-location-to-n-to-n-relation`

This migration has been generated by KennHuang at 4/2/2020, 12:00:46 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `checkin-covid19`.`_SterilizeLocationToSterilizeLog` (
    `A` int NOT NULL ,
    `B` int NOT NULL 
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `checkin-covid19`.`SterilizeLog` DROP FOREIGN KEY `SterilizeLog_ibfk_2`,
DROP COLUMN `locationId`;

CREATE UNIQUE INDEX `_SterilizeLocationToSterilizeLog_AB_unique` ON `checkin-covid19`.`_SterilizeLocationToSterilizeLog`(`A`,`B`)

CREATE  INDEX `_SterilizeLocationToSterilizeLog_B_index` ON `checkin-covid19`.`_SterilizeLocationToSterilizeLog`(`B`)

ALTER TABLE `checkin-covid19`.`_SterilizeLocationToSterilizeLog` ADD FOREIGN KEY (`A`) REFERENCES `checkin-covid19`.`SterilizeLocation`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `checkin-covid19`.`_SterilizeLocationToSterilizeLog` ADD FOREIGN KEY (`B`) REFERENCES `checkin-covid19`.`SterilizeLog`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200402115943-init..20200402120046-change-location-to-n-to-n-relation
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource mysql {
-  url = "***"
+  url      = env("DATABASE_URL")
   provider = "mysql"
 }
 generator client {
@@ -44,13 +44,12 @@
   id         Int               @default(autoincrement()) @id
   user       User              @relation(fields: [userId], references: [studentNumber])
   userId     String
   timestamp  DateTime
-  location   SterilizeLocation @relation(fields: [locationId], references: [id])
-  locationId Int
+  location   SterilizeLocation[] @relation(references: [id])
 }
 model SterilizeLocation {
   id            Int            @default(autoincrement()) @id
   name          String
-  sterilizeLogs SterilizeLog[]
+  sterilizeLogs SterilizeLog[] @relation(references: [id])
 }
```


