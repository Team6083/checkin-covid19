# Migration `20200323103017-update-database`

This migration has been generated by KennHuang at 3/23/2020, 10:30:17 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE `checkin-covid19`.`User` (
    `cardUUID` varchar(191)   ,
    `name` varchar(191) NOT NULL DEFAULT '' ,
    `studentNumber` varchar(191) NOT NULL  ,
    PRIMARY KEY (`studentNumber`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `checkin-covid19`.`CheckinLog` (
    `checkinAt` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    `id` int NOT NULL  AUTO_INCREMENT,
    `temperature` Decimal(65,30) NOT NULL DEFAULT 0 ,
    `user` varchar(191) NOT NULL ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `checkin-covid19`.`AdminAccounts` (
    `id` int NOT NULL  AUTO_INCREMENT,
    `passwordHash` varchar(191) NOT NULL DEFAULT '' ,
    `salt` varchar(191) NOT NULL DEFAULT '' ,
    `userName` varchar(191) NOT NULL DEFAULT '' ,
    PRIMARY KEY (`id`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE TABLE `checkin-covid19`.`Token` (
    `exp` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    `iat` datetime(3) NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    `iss` int NOT NULL ,
    `jti` int NOT NULL  AUTO_INCREMENT,
    `scopes` varchar(191) NOT NULL DEFAULT '' ,
    PRIMARY KEY (`jti`)
) 
DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

CREATE UNIQUE INDEX `AdminAccounts.userName` ON `checkin-covid19`.`AdminAccounts`(`userName`)

ALTER TABLE `checkin-covid19`.`CheckinLog` ADD FOREIGN KEY (`user`) REFERENCES `checkin-covid19`.`User`(`studentNumber`) ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE `checkin-covid19`.`Token` ADD FOREIGN KEY (`iss`) REFERENCES `checkin-covid19`.`AdminAccounts`(`id`) ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200323102716-init..20200323103017-update-database
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource sqlite {
-  url = "***"
-  provider = "sqlite"
+  url      = env("DATABASE_URL")
+  provider = "mysql"
 }
 generator client {
   provider = "prisma-client-js"
```


